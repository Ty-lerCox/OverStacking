{"version":3,"sources":["../../src/pages/layout/profile/update-profile/update-profile.module.ts","../../src/pages/layout/profile/update-profile/update-profile.ts"],"names":[],"mappings":"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","file":"6.js","sourcesContent":["import { NgModule } from '@angular/core';\nimport { IonicPageModule } from 'ionic-angular';\nimport { UpdateProfilePage } from './update-profile';\n\n@NgModule({\n  declarations: [\n    UpdateProfilePage,\n  ],\n  imports: [\n    IonicPageModule.forChild(UpdateProfilePage),\n  ],\n})\nexport class UpdateProfilePageModule {}\n\n\n\n// WEBPACK FOOTER //\n// ./src/pages/layout/profile/update-profile/update-profile.module.ts","import { Component } from '@angular/core';\nimport { IonicPage, NavController, NavParams, NavOptions, ToastController } from 'ionic-angular';\nimport { AngularFireAuth } from 'angularfire2/auth';\nimport { AngularFirestore } from 'angularfire2/firestore';\nimport { IProfile } from '../../../../app/app.interfaces';\nimport { Keyboard } from '@ionic-native/keyboard';\n\n/**\n * Generated class for the UpdateProfilePage page.\n *\n * See https://ionicframework.com/docs/components/#navigation for more info on\n * Ionic pages and navigation.\n */\n\n@IonicPage()\n@Component({\n  selector: 'page-update-profile',\n  templateUrl: 'update-profile.html',\n})\nexport class UpdateProfilePage {\n  profile: IProfile;\n\n  constructor(private toast: ToastController, private keyboard: Keyboard, public navCtrl: NavController, public navParams: NavParams, public afAuth: AngularFireAuth, public afs: AngularFirestore) {\n  }\n\n  ionViewDidLoad() {\n    this.getProfileData();\n    document.addEventListener('keydown', (key) => {this.handleEnter(key)} );\n  }\n\n  handleEnter(key) {\n    //console.log(key.keyCode);\n    if (key.keyCode == 13) {\n      this.keyboard.close();\n    }\n    //this.code = key.keyCode;\n  }\n\n  async getProfileData() {\n    this.afAuth.auth.onAuthStateChanged(user => {\n      if (user) {\n        this.afs.collection(\"profiles\").doc<IProfile>(this.afAuth.auth.currentUser.uid).valueChanges().subscribe(data => {\n          if (data) {\n            this.profile = data;\n          } else {\n            this.profile = {} as IProfile;\n            this.profile.Beers = 100;\n          }\n        });\n      } else {\n        this.navCtrl.popToRoot();\n      }\n    });\n  }\n\n  update() {\n    console.log(this.profile);\n\n    this.afs.collection(\"profiles\", ref => ref.where(\"Username\", \"==\", this.profile.Username)).snapshotChanges().subscribe(data => {\n      if (data[0] == null) {\n        this.updateProfile();\n        return;\n      }\n      var id = data[0].payload.doc.id;\n      // if username exists\n      if (id) {\n        console.log(\"user exists\");\n        // if ID == user's ID\n        if (id == this.afAuth.auth.currentUser.uid) {\n          // allow update\n            this.updateProfile();\n        } else {\n          // disallow update\n          this.toast.create({\n            message: \"Username is already taken.\",\n            duration: 2000\n          }).present();\n        }\n      } else {\n        // allow update\n        console.log(id);\n        this.updateProfile();\n      }\n    });\n  }\n\n  async updateProfile() {\n    this.afs.collection(\"profiles\").doc<IProfile>(this.afAuth.auth.currentUser.uid).set(this.profile)\n    .then(() => {\n      let options = {\n        action: \"updatedProfile\"\n      } as NavOptions;\n      this.navCtrl.setRoot(\"Category1Page\", options);\n    });\n  }\n\n  cancel() {\n    let options = {\n    } as NavOptions;\n    this.navCtrl.setRoot(\"Category1Page\", options);\n  }\n\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/pages/layout/profile/update-profile/update-profile.ts"],"sourceRoot":""}