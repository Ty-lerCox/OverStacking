{"version":3,"sources":["../../src/pages/layout/profile/update-profile/update-profile.module.ts","../../src/pages/layout/profile/update-profile/update-profile.ts"],"names":[],"mappings":"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","file":"6.js","sourcesContent":["import { NgModule } from '@angular/core';\r\nimport { IonicPageModule } from 'ionic-angular';\r\nimport { UpdateProfilePage } from './update-profile';\r\n\r\n@NgModule({\r\n  declarations: [\r\n    UpdateProfilePage,\r\n  ],\r\n  imports: [\r\n    IonicPageModule.forChild(UpdateProfilePage),\r\n  ],\r\n})\r\nexport class UpdateProfilePageModule {}\r\n\n\n\n// WEBPACK FOOTER //\n// ./src/pages/layout/profile/update-profile/update-profile.module.ts","import { Component } from '@angular/core';\r\nimport { IonicPage, NavController, NavParams, NavOptions, ToastController } from 'ionic-angular';\r\nimport { AngularFireAuth } from 'angularfire2/auth';\r\nimport { AngularFirestore } from 'angularfire2/firestore';\r\nimport { IProfile } from '../../../../app/app.interfaces';\r\nimport { Keyboard } from '@ionic-native/keyboard';\r\n\r\n/**\r\n * Generated class for the UpdateProfilePage page.\r\n *\r\n * See https://ionicframework.com/docs/components/#navigation for more info on\r\n * Ionic pages and navigation.\r\n */\r\n\r\n@IonicPage()\r\n@Component({\r\n  selector: 'page-update-profile',\r\n  templateUrl: 'update-profile.html',\r\n})\r\nexport class UpdateProfilePage {\r\n  profile: IProfile;\r\n\r\n  constructor(private toast: ToastController, private keyboard: Keyboard, public navCtrl: NavController, public navParams: NavParams, public afAuth: AngularFireAuth, public afs: AngularFirestore) {\r\n  }\r\n\r\n  ionViewDidLoad() {\r\n    this.getProfileData();\r\n    document.addEventListener('keydown', (key) => {this.handleEnter(key)} );\r\n  }\r\n\r\n  handleEnter(key) {\r\n    //console.log(key.keyCode);\r\n    if (key.keyCode == 13) {\r\n      this.keyboard.close();\r\n    }\r\n    //this.code = key.keyCode;\r\n  }\r\n\r\n  async getProfileData() {\r\n    this.afAuth.auth.onAuthStateChanged(user => {\r\n      if (user) {\r\n        this.afs.collection(\"profiles\").doc<IProfile>(this.afAuth.auth.currentUser.uid).valueChanges().subscribe(data => {\r\n          if (data) {\r\n            this.profile = data;\r\n          } else {\r\n            this.profile = {} as IProfile;\r\n            this.profile.Beers = 100;\r\n          }\r\n        });\r\n      } else {\r\n        this.navCtrl.popToRoot();\r\n      }\r\n    });\r\n  }\r\n\r\n  update() {\r\n    console.log(this.profile);\r\n\r\n    this.afs.collection(\"profiles\", ref => ref.where(\"Username\", \"==\", this.profile.Username)).snapshotChanges().subscribe(data => {\r\n      if (data[0] == null) {\r\n        this.updateProfile();\r\n        return;\r\n      }\r\n      var id = data[0].payload.doc.id;\r\n      // if username exists\r\n      if (id) {\r\n        console.log(\"user exists\");\r\n        // if ID == user's ID\r\n        if (id == this.afAuth.auth.currentUser.uid) {\r\n          // allow update\r\n            this.updateProfile();\r\n        } else {\r\n          // disallow update\r\n          this.toast.create({\r\n            message: \"Username is already taken.\",\r\n            duration: 2000\r\n          }).present();\r\n        }\r\n      } else {\r\n        // allow update\r\n        console.log(id);\r\n        this.updateProfile();\r\n      }\r\n    });\r\n  }\r\n\r\n  async updateProfile() {\r\n    this.afs.collection(\"profiles\").doc<IProfile>(this.afAuth.auth.currentUser.uid).set(this.profile)\r\n    .then(() => {\r\n      let options = {\r\n        action: \"updatedProfile\"\r\n      } as NavOptions;\r\n      this.navCtrl.setRoot(\"Category1Page\", options);\r\n    });\r\n  }\r\n\r\n  cancel() {\r\n    let options = {\r\n    } as NavOptions;\r\n    this.navCtrl.setRoot(\"Category1Page\", options);\r\n  }\r\n\r\n}\r\n\n\n\n// WEBPACK FOOTER //\n// ./src/pages/layout/profile/update-profile/update-profile.ts"],"sourceRoot":""}